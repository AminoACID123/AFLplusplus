#include "hci.h"
#include "util.h"
#include <map>
#include <string>
using namespace std;

#define HCI(x)                                                                 \
  { x, #x }

map<uint8_t, string> hci_evts = {
    HCI(BT_HCI_EVT_INQUIRY_COMPLETE),
    HCI(BT_HCI_EVT_INQUIRY_RESULT),
    HCI(BT_HCI_EVT_CONN_COMPLETE),
    HCI(BT_HCI_EVT_CONN_REQUEST),
    HCI(BT_HCI_EVT_DISCONNECT_COMPLETE),
    HCI(BT_HCI_EVT_AUTH_COMPLETE),
    HCI(BT_HCI_EVT_REMOTE_NAME_REQUEST_COMPLETE),
    HCI(BT_HCI_EVT_ENCRYPT_CHANGE),
    HCI(BT_HCI_EVT_CHANGE_CONN_LINK_KEY_COMPLETE),
    HCI(BT_HCI_EVT_LINK_KEY_TYPE_CHANGED),
    HCI(BT_HCI_EVT_REMOTE_FEATURES_COMPLETE),
    HCI(BT_HCI_EVT_REMOTE_VERSION_COMPLETE),
    HCI(BT_HCI_EVT_QOS_SETUP_COMPLETE),
    HCI(BT_HCI_EVT_CMD_COMPLETE),
    HCI(BT_HCI_EVT_CMD_STATUS),
    HCI(BT_HCI_EVT_HARDWARE_ERROR),
    HCI(BT_HCI_EVT_FLUSH_OCCURRED),
    HCI(BT_HCI_EVT_ROLE_CHANGE),
    HCI(BT_HCI_EVT_NUM_COMPLETED_PACKETS),
    HCI(BT_HCI_EVT_MODE_CHANGE),
    HCI(BT_HCI_EVT_RETURN_LINK_KEYS),
    HCI(BT_HCI_EVT_PIN_CODE_REQUEST),
    HCI(BT_HCI_EVT_LINK_KEY_REQUEST),
    HCI(BT_HCI_EVT_LINK_KEY_NOTIFY),
    HCI(BT_HCI_EVT_LOOPBACK_COMMAND),
    HCI(BT_HCI_EVT_DATA_BUFFER_OVERFLOW),
    HCI(BT_HCI_EVT_MAX_SLOTS_CHANGE),
    HCI(BT_HCI_EVT_CLOCK_OFFSET_COMPLETE),
    HCI(BT_HCI_EVT_CONN_PKT_TYPE_CHANGED),
    HCI(BT_HCI_EVT_QOS_VIOLATION),
    HCI(BT_HCI_EVT_PSCAN_MODE_CHANGE),
    HCI(BT_HCI_EVT_PSCAN_REP_MODE_CHANGE),
    HCI(BT_HCI_EVT_FLOW_SPEC_COMPLETE),
    HCI(BT_HCI_EVT_INQUIRY_RESULT_WITH_RSSI),
    HCI(BT_HCI_EVT_REMOTE_EXT_FEATURES_COMPLETE),
    HCI(BT_HCI_EVT_SYNC_CONN_COMPLETE),
    HCI(BT_HCI_EVT_SYNC_CONN_CHANGED),
    HCI(BT_HCI_EVT_SNIFF_SUBRATING),
    HCI(BT_HCI_EVT_EXT_INQUIRY_RESULT),
    HCI(BT_HCI_EVT_ENCRYPT_KEY_REFRESH_COMPLETE),
    HCI(BT_HCI_EVT_IO_CAPABILITY_REQUEST),
    HCI(BT_HCI_EVT_IO_CAPABILITY_RESPONSE),
    HCI(BT_HCI_EVT_USER_CONFIRM_REQUEST),
    HCI(BT_HCI_EVT_USER_PASSKEY_REQUEST),
    HCI(BT_HCI_EVT_REMOTE_OOB_DATA_REQUEST),
    HCI(BT_HCI_EVT_SIMPLE_PAIRING_COMPLETE),
    HCI(BT_HCI_EVT_LINK_SUPV_TIMEOUT_CHANGED),
    HCI(BT_HCI_EVT_ENHANCED_FLUSH_COMPLETE),
    HCI(BT_HCI_EVT_USER_PASSKEY_NOTIFY),
    HCI(BT_HCI_EVT_KEYPRESS_NOTIFY),
    HCI(BT_HCI_EVT_REMOTE_HOST_FEATURES_NOTIFY),
    HCI(BT_HCI_EVT_LE_META_EVENT),
    HCI(BT_HCI_EVT_PHY_LINK_COMPLETE),
    HCI(BT_HCI_EVT_CHANNEL_SELECTED),
    HCI(BT_HCI_EVT_DISCONN_PHY_LINK_COMPLETE),
    HCI(BT_HCI_EVT_PHY_LINK_LOSS_EARLY_WARNING),
    HCI(BT_HCI_EVT_PHY_LINK_RECOVERY),
    HCI(BT_HCI_EVT_LOGIC_LINK_COMPLETE),
    HCI(BT_HCI_EVT_DISCONN_LOGIC_LINK_COMPLETE),
    HCI(BT_HCI_EVT_FLOW_SPEC_MODIFY_COMPLETE),
    HCI(BT_HCI_EVT_NUM_COMPLETED_DATA_BLOCKS),
    HCI(BT_HCI_EVT_SHORT_RANGE_MODE_CHANGE),
    HCI(BT_HCI_EVT_AMP_STATUS_CHANGE),
    HCI(BT_HCI_EVT_TRIGGERED_CLOCK_CAPTURE),
    HCI(BT_HCI_EVT_SYNC_TRAIN_COMPLETE),
    HCI(BT_HCI_EVT_SYNC_TRAIN_RECEIVED),
    HCI(BT_HCI_EVT_PERIPHERAL_BROADCAST_RECEIVE),
    HCI(BT_HCI_EVT_PERIPHERAL_BROADCAST_TIMEOUT),
    HCI(BT_HCI_EVT_TRUNCATED_PAGE_COMPLETE),
    HCI(BT_HCI_EVT_PERIPHERAL_PAGE_RESPONSE_TIMEOUT),
    HCI(BT_HCI_EVT_PERIPHERAL_BROADCAST_CHANNEL_MAP_CHANGE),
    HCI(BT_HCI_EVT_INQUIRY_RESPONSE_NOTIFY),
    HCI(BT_HCI_EVT_AUTH_PAYLOAD_TIMEOUT_EXPIRED)};

map<uint8_t, string> hci_le_evts = {
    HCI(BT_HCI_EVT_LE_CONN_COMPLETE),
    HCI(BT_HCI_EVT_LE_ADV_REPORT),
    HCI(BT_HCI_EVT_LE_CONN_UPDATE_COMPLETE),
    HCI(BT_HCI_EVT_LE_REMOTE_FEATURES_COMPLETE),
    HCI(BT_HCI_EVT_LE_LONG_TERM_KEY_REQUEST),
    HCI(BT_HCI_EVT_LE_CONN_PARAM_REQUEST),
    HCI(BT_HCI_EVT_LE_DATA_LENGTH_CHANGE),
    HCI(BT_HCI_EVT_LE_READ_LOCAL_PK256_COMPLETE),
    HCI(BT_HCI_EVT_LE_GENERATE_DHKEY_COMPLETE),
    HCI(BT_HCI_EVT_LE_ENHANCED_CONN_COMPLETE),
    HCI(BT_HCI_EVT_LE_DIRECT_ADV_REPORT),
    HCI(BT_HCI_EVT_LE_PHY_UPDATE_COMPLETE),
    HCI(BT_HCI_EVT_LE_EXT_ADV_REPORT),
    HCI(BT_HCI_EVT_LE_PA_SYNC_ESTABLISHED),
    HCI(BT_HCI_EVT_LE_PA_REPORT),
    HCI(BT_HCI_EVT_LE_PA_SYNC_LOST),
    HCI(BT_HCI_EVT_LE_ADV_SET_TERM),
    HCI(BT_HCI_EVT_LE_SCAN_REQ_RECEIVED),
    HCI(BT_HCI_EVT_LE_CHAN_SELECT_ALG),
    HCI(BT_HCI_EVT_LE_CTE_REQUEST_FAILED),
    HCI(BT_HCI_EVT_LE_PA_SYNC_TRANS_REC),
    HCI(BT_HCI_EVT_LE_CIS_ESTABLISHED),
    HCI(BT_HCI_EVT_LE_CIS_REQ),
    HCI(BT_HCI_EVT_LE_BIG_COMPLETE),
    HCI(BT_HCI_EVT_LE_BIG_TERMINATE),
    HCI(BT_HCI_EVT_LE_BIG_SYNC_ESTABILISHED),
    HCI(BT_HCI_EVT_LE_BIG_SYNC_LOST),
    HCI(BT_HCI_EVT_LE_REQ_PEER_SCA_COMPLETE)};

map<uint16_t, string> hci_cmds = {
    HCI(BT_HCI_CMD_INQUIRY),
    HCI(BT_HCI_CMD_INQUIRY_CANCEL),
    HCI(BT_HCI_CMD_PERIODIC_INQUIRY),
    HCI(BT_HCI_CMD_EXIT_PERIODIC_INQUIRY),
    HCI(BT_HCI_CMD_CREATE_CONN),
    HCI(BT_HCI_CMD_DISCONNECT),
    HCI(BT_HCI_CMD_ADD_SCO_CONN),
    HCI(BT_HCI_CMD_CREATE_CONN_CANCEL),
    HCI(BT_HCI_CMD_ACCEPT_CONN_REQUEST),
    HCI(BT_HCI_CMD_REJECT_CONN_REQUEST),
    HCI(BT_HCI_CMD_LINK_KEY_REQUEST_REPLY),
    HCI(BT_HCI_CMD_LINK_KEY_REQUEST_NEG_REPLY),
    HCI(BT_HCI_CMD_PIN_CODE_REQUEST_REPLY),
    HCI(BT_HCI_CMD_PIN_CODE_REQUEST_NEG_REPLY),
    HCI(BT_HCI_CMD_CHANGE_CONN_PKT_TYPE),
    HCI(BT_HCI_CMD_AUTH_REQUESTED),
    HCI(BT_HCI_CMD_SET_CONN_ENCRYPT),
    HCI(BT_HCI_CMD_CHANGE_CONN_LINK_KEY),
    HCI(BT_HCI_CMD_LINK_KEY_SELECTION),
    HCI(BT_HCI_CMD_REMOTE_NAME_REQUEST),
    HCI(BT_HCI_CMD_REMOTE_NAME_REQUEST_CANCEL),
    HCI(BT_HCI_CMD_READ_REMOTE_FEATURES),
    HCI(BT_HCI_CMD_READ_REMOTE_EXT_FEATURES),
    HCI(BT_HCI_CMD_READ_REMOTE_VERSION),
    HCI(BT_HCI_CMD_READ_CLOCK_OFFSET),
    HCI(BT_HCI_CMD_READ_LMP_HANDLE),
    HCI(BT_HCI_CMD_SETUP_SYNC_CONN),
    HCI(BT_HCI_CMD_ACCEPT_SYNC_CONN_REQUEST),
    HCI(BT_HCI_CMD_REJECT_SYNC_CONN_REQUEST),
    HCI(BT_HCI_CMD_IO_CAPABILITY_REQUEST_REPLY),
    HCI(BT_HCI_CMD_USER_CONFIRM_REQUEST_REPLY),
    HCI(BT_HCI_CMD_USER_CONFIRM_REQUEST_NEG_REPLY),
    HCI(BT_HCI_CMD_USER_PASSKEY_REQUEST_REPLY),
    HCI(BT_HCI_CMD_USER_PASSKEY_REQUEST_NEG_REPLY),
    HCI(BT_HCI_CMD_REMOTE_OOB_DATA_REQUEST_REPLY),
    HCI(BT_HCI_CMD_REMOTE_OOB_DATA_REQUEST_NEG_REPLY),
    HCI(BT_HCI_CMD_IO_CAPABILITY_REQUEST_NEG_REPLY),
    HCI(BT_HCI_CMD_CREATE_PHY_LINK),
    HCI(BT_HCI_CMD_ACCEPT_PHY_LINK),
    HCI(BT_HCI_CMD_DISCONN_PHY_LINK),
    HCI(BT_HCI_CMD_CREATE_LOGIC_LINK),
    HCI(BT_HCI_CMD_ACCEPT_LOGIC_LINK),
    HCI(BT_HCI_CMD_DISCONN_LOGIC_LINK),
    HCI(BT_HCI_CMD_LOGIC_LINK_CANCEL),
    HCI(BT_HCI_CMD_FLOW_SPEC_MODIFY),
    HCI(BT_HCI_CMD_ENHANCED_SETUP_SYNC_CONN),
    HCI(BT_HCI_CMD_ENHANCED_ACCEPT_SYNC_CONN_REQUEST),
    HCI(BT_HCI_CMD_TRUNCATED_PAGE),
    HCI(BT_HCI_CMD_TRUNCATED_PAGE_CANCEL),
    HCI(BT_HCI_CMD_SET_PERIPHERAL_BROADCAST),
    HCI(BT_HCI_CMD_SET_PERIPHERAL_BROADCAST_RECEIVE),
    HCI(BT_HCI_CMD_START_SYNC_TRAIN),
    HCI(BT_HCI_CMD_RECEIVE_SYNC_TRAIN),
    HCI(BT_HCI_CMD_REMOTE_OOB_EXT_DATA_REQUEST_REPLY),
    HCI(BT_HCI_CMD_HOLD_MODE),
    HCI(BT_HCI_CMD_SNIFF_MODE),
    HCI(BT_HCI_CMD_EXIT_SNIFF_MODE),
    HCI(BT_HCI_CMD_PARK_STATE),
    HCI(BT_HCI_CMD_EXIT_PARK_STATE),
    HCI(BT_HCI_CMD_QOS_SETUP),
    HCI(BT_HCI_CMD_ROLE_DISCOVERY),
    HCI(BT_HCI_CMD_SWITCH_ROLE),
    HCI(BT_HCI_CMD_READ_LINK_POLICY),
    HCI(BT_HCI_CMD_WRITE_LINK_POLICY),
    HCI(BT_HCI_CMD_READ_DEFAULT_LINK_POLICY),
    HCI(BT_HCI_CMD_WRITE_DEFAULT_LINK_POLICY),
    HCI(BT_HCI_CMD_FLOW_SPEC),
    HCI(BT_HCI_CMD_SNIFF_SUBRATING),
    HCI(BT_HCI_CMD_SET_EVENT_MASK),
    HCI(BT_HCI_CMD_RESET),
    HCI(BT_HCI_CMD_SET_EVENT_FILTER),
    HCI(BT_HCI_CMD_FLUSH),
    HCI(BT_HCI_CMD_READ_PIN_TYPE),
    HCI(BT_HCI_CMD_WRITE_PIN_TYPE),
    HCI(BT_HCI_CMD_CREATE_NEW_UNIT_KEY),
    HCI(BT_HCI_CMD_READ_STORED_LINK_KEY),
    HCI(BT_HCI_CMD_WRITE_STORED_LINK_KEY),
    HCI(BT_HCI_CMD_DELETE_STORED_LINK_KEY),
    HCI(BT_HCI_CMD_WRITE_LOCAL_NAME),
    HCI(BT_HCI_CMD_READ_LOCAL_NAME),
    HCI(BT_HCI_CMD_READ_CONN_ACCEPT_TIMEOUT),
    HCI(BT_HCI_CMD_WRITE_CONN_ACCEPT_TIMEOUT),
    HCI(BT_HCI_CMD_READ_PAGE_TIMEOUT),
    HCI(BT_HCI_CMD_WRITE_PAGE_TIMEOUT),
    HCI(BT_HCI_CMD_READ_SCAN_ENABLE),
    HCI(BT_HCI_CMD_WRITE_SCAN_ENABLE),
    HCI(BT_HCI_CMD_READ_PAGE_SCAN_ACTIVITY),
    HCI(BT_HCI_CMD_WRITE_PAGE_SCAN_ACTIVITY),
    HCI(BT_HCI_CMD_READ_INQUIRY_SCAN_ACTIVITY),
    HCI(BT_HCI_CMD_WRITE_INQUIRY_SCAN_ACTIVITY),
    HCI(BT_HCI_CMD_READ_AUTH_ENABLE),
    HCI(BT_HCI_CMD_WRITE_AUTH_ENABLE),
    HCI(BT_HCI_CMD_READ_ENCRYPT_MODE),
    HCI(BT_HCI_CMD_WRITE_ENCRYPT_MODE),
    HCI(BT_HCI_CMD_READ_CLASS_OF_DEV),
    HCI(BT_HCI_CMD_WRITE_CLASS_OF_DEV),
    HCI(BT_HCI_CMD_READ_VOICE_SETTING),
    HCI(BT_HCI_CMD_WRITE_VOICE_SETTING),
    HCI(BT_HCI_CMD_READ_AUTO_FLUSH_TIMEOUT),
    HCI(BT_HCI_CMD_WRITE_AUTO_FLUSH_TIMEOUT),
    HCI(BT_HCI_CMD_READ_NUM_BROADCAST_RETRANS),
    HCI(BT_HCI_CMD_WRITE_NUM_BROADCAST_RETRANS),
    HCI(BT_HCI_CMD_READ_HOLD_MODE_ACTIVITY),
    HCI(BT_HCI_CMD_WRITE_HOLD_MODE_ACTIVITY),
    HCI(BT_HCI_CMD_READ_TX_POWER),
    HCI(BT_HCI_CMD_READ_SYNC_FLOW_CONTROL),
    HCI(BT_HCI_CMD_WRITE_SYNC_FLOW_CONTROL),
    HCI(BT_HCI_CMD_SET_HOST_FLOW_CONTROL),
    HCI(BT_HCI_CMD_HOST_BUFFER_SIZE),
    HCI(BT_HCI_CMD_HOST_NUM_COMPLETED_PACKETS),
    HCI(BT_HCI_CMD_READ_LINK_SUPV_TIMEOUT),
    HCI(BT_HCI_CMD_WRITE_LINK_SUPV_TIMEOUT),
    HCI(BT_HCI_CMD_READ_NUM_SUPPORTED_IAC),
    HCI(BT_HCI_CMD_READ_CURRENT_IAC_LAP),
    HCI(BT_HCI_CMD_WRITE_CURRENT_IAC_LAP),
    HCI(BT_HCI_CMD_READ_PAGE_SCAN_PERIOD_MODE),
    HCI(BT_HCI_CMD_WRITE_PAGE_SCAN_PERIOD_MODE),
    HCI(BT_HCI_CMD_READ_PAGE_SCAN_MODE),
    HCI(BT_HCI_CMD_WRITE_PAGE_SCAN_MODE),
    HCI(BT_HCI_CMD_SET_AFH_HOST_CLASSIFICATION),
    HCI(BT_HCI_CMD_READ_INQUIRY_SCAN_TYPE),
    HCI(BT_HCI_CMD_WRITE_INQUIRY_SCAN_TYPE),
    HCI(BT_HCI_CMD_READ_INQUIRY_MODE),
    HCI(BT_HCI_CMD_WRITE_INQUIRY_MODE),
    HCI(BT_HCI_CMD_READ_PAGE_SCAN_TYPE),
    HCI(BT_HCI_CMD_WRITE_PAGE_SCAN_TYPE),
    HCI(BT_HCI_CMD_READ_AFH_ASSESSMENT_MODE),
    HCI(BT_HCI_CMD_WRITE_AFH_ASSESSMENT_MODE),
    HCI(BT_HCI_CMD_READ_EXT_INQUIRY_RESPONSE),
    HCI(BT_HCI_CMD_WRITE_EXT_INQUIRY_RESPONSE),
    HCI(BT_HCI_CMD_REFRESH_ENCRYPT_KEY),
    HCI(BT_HCI_CMD_READ_SIMPLE_PAIRING_MODE),
    HCI(BT_HCI_CMD_WRITE_SIMPLE_PAIRING_MODE),
    HCI(BT_HCI_CMD_READ_LOCAL_OOB_DATA),
    HCI(BT_HCI_CMD_READ_INQUIRY_RESP_TX_POWER),
    HCI(BT_HCI_CMD_WRITE_INQUIRY_TX_POWER),
    HCI(BT_HCI_CMD_READ_ERRONEOUS_REPORTING),
    HCI(BT_HCI_CMD_WRITE_ERRONEOUS_REPORTING),
    HCI(BT_HCI_CMD_ENHANCED_FLUSH),
    HCI(BT_HCI_CMD_SEND_KEYPRESS_NOTIFY),
    HCI(BT_HCI_CMD_SET_EVENT_MASK_PAGE2),
    HCI(BT_HCI_CMD_READ_LOCATION_DATA),
    HCI(BT_HCI_CMD_WRITE_LOCATION_DATA),
    HCI(BT_HCI_CMD_READ_FLOW_CONTROL_MODE),
    HCI(BT_HCI_CMD_WRITE_FLOW_CONTROL_MODE),
    HCI(BT_HCI_CMD_READ_ENHANCED_TX_POWER),
    HCI(BT_HCI_CMD_SHORT_RANGE_MODE),
    HCI(BT_HCI_CMD_READ_LE_HOST_SUPPORTED),
    HCI(BT_HCI_CMD_WRITE_LE_HOST_SUPPORTED),
    HCI(BT_HCI_CMD_SET_RESERVED_LT_ADDR),
    HCI(BT_HCI_CMD_DELETE_RESERVED_LT_ADDR),
    HCI(BT_HCI_CMD_SET_PERIPHERAL_BROADCAST_DATA),
    HCI(BT_HCI_CMD_READ_SYNC_TRAIN_PARAMS),
    HCI(BT_HCI_CMD_WRITE_SYNC_TRAIN_PARAMS),
    HCI(BT_HCI_CMD_READ_SECURE_CONN_SUPPORT),
    HCI(BT_HCI_CMD_WRITE_SECURE_CONN_SUPPORT),
    HCI(BT_HCI_CMD_READ_AUTH_PAYLOAD_TIMEOUT),
    HCI(BT_HCI_CMD_WRITE_AUTH_PAYLOAD_TIMEOUT),
    HCI(BT_HCI_CMD_READ_LOCAL_OOB_EXT_DATA),
    HCI(BT_HCI_CMD_READ_EXT_PAGE_TIMEOUT),
    HCI(BT_HCI_CMD_WRITE_EXT_PAGE_TIMEOUT),
    HCI(BT_HCI_CMD_READ_EXT_INQUIRY_LENGTH),
    HCI(BT_HCI_CMD_WRITE_EXT_INQUIRY_LENGTH),
    HCI(BT_HCI_CMD_CONFIG_DATA_PATH),
    HCI(BT_HCI_CMD_READ_LOCAL_VERSION),
    HCI(BT_HCI_CMD_READ_LOCAL_COMMANDS),
    HCI(BT_HCI_CMD_READ_LOCAL_FEATURES),
    HCI(BT_HCI_CMD_READ_LOCAL_EXT_FEATURES),
    HCI(BT_HCI_CMD_READ_BUFFER_SIZE),
    HCI(BT_HCI_CMD_READ_COUNTRY_CODE),
    HCI(BT_HCI_CMD_READ_BD_ADDR),
    HCI(BT_HCI_CMD_READ_DATA_BLOCK_SIZE),
    HCI(BT_HCI_CMD_READ_LOCAL_CODECS),
    HCI(BT_HCI_CMD_READ_LOCAL_PAIRING_OPTIONS),
    HCI(BT_HCI_CMD_READ_LOCAL_CODECS_V2),
    HCI(BT_HCI_CMD_READ_LOCAL_CODEC_CAPS),
    HCI(BT_HCI_CMD_READ_LOCAL_CTRL_DELAY),
    HCI(BT_HCI_CMD_READ_FAILED_CONTACT_COUNTER),
    HCI(BT_HCI_CMD_RESET_FAILED_CONTACT_COUNTER),
    HCI(BT_HCI_CMD_READ_LINK_QUALITY),
    HCI(BT_HCI_CMD_READ_RSSI),
    HCI(BT_HCI_CMD_READ_AFH_CHANNEL_MAP),
    HCI(BT_HCI_CMD_READ_CLOCK),
    HCI(BT_HCI_CMD_READ_ENCRYPT_KEY_SIZE),
    HCI(BT_HCI_CMD_READ_LOCAL_AMP_INFO),
    HCI(BT_HCI_CMD_READ_LOCAL_AMP_ASSOC),
    HCI(BT_HCI_CMD_WRITE_REMOTE_AMP_ASSOC),
    HCI(BT_HCI_CMD_GET_MWS_TRANSPORT_CONFIG),
    HCI(BT_HCI_CMD_SET_TRIGGERED_CLOCK_CAPTURE),
    HCI(BT_HCI_CMD_READ_LOOPBACK_MODE),
    HCI(BT_HCI_CMD_WRITE_LOOPBACK_MODE),
    HCI(BT_HCI_CMD_ENABLE_DUT_MODE),
    HCI(BT_HCI_CMD_WRITE_SSP_DEBUG_MODE),
    HCI(BT_HCI_CMD_LE_SET_EVENT_MASK),
    HCI(BT_HCI_CMD_LE_READ_BUFFER_SIZE),
    HCI(BT_HCI_CMD_LE_READ_LOCAL_FEATURES),
    HCI(BT_HCI_CMD_LE_SET_RANDOM_ADDRESS),
    HCI(BT_HCI_CMD_LE_SET_ADV_PARAMETERS),
    HCI(BT_HCI_CMD_LE_READ_ADV_TX_POWER),
    HCI(BT_HCI_CMD_LE_SET_ADV_DATA),
    HCI(BT_HCI_CMD_LE_SET_SCAN_RSP_DATA),
    HCI(BT_HCI_CMD_LE_SET_ADV_ENABLE),
    HCI(BT_HCI_CMD_LE_SET_SCAN_PARAMETERS),
    HCI(BT_HCI_CMD_LE_SET_SCAN_ENABLE),
    HCI(BT_HCI_CMD_LE_CREATE_CONN),
    HCI(BT_HCI_CMD_LE_CREATE_CONN_CANCEL),
    HCI(BT_HCI_CMD_LE_READ_ACCEPT_LIST_SIZE),
    HCI(BT_HCI_CMD_LE_CLEAR_ACCEPT_LIST),
    HCI(BT_HCI_CMD_LE_ADD_TO_ACCEPT_LIST),
    HCI(BT_HCI_CMD_LE_REMOVE_FROM_ACCEPT_LIST),
    HCI(BT_HCI_CMD_LE_CONN_UPDATE),
    HCI(BT_HCI_CMD_LE_SET_HOST_CLASSIFICATION),
    HCI(BT_HCI_CMD_LE_READ_CHANNEL_MAP),
    HCI(BT_HCI_CMD_LE_READ_REMOTE_FEATURES),
    HCI(BT_HCI_CMD_LE_ENCRYPT),
    HCI(BT_HCI_CMD_LE_RAND),
    HCI(BT_HCI_CMD_LE_START_ENCRYPT),
    HCI(BT_HCI_CMD_LE_LTK_REQ_REPLY),
    HCI(BT_HCI_CMD_LE_LTK_REQ_NEG_REPLY),
    HCI(BT_HCI_CMD_LE_READ_SUPPORTED_STATES),
    HCI(BT_HCI_CMD_LE_RECEIVER_TEST),
    HCI(BT_HCI_CMD_LE_TRANSMITTER_TEST),
    HCI(BT_HCI_CMD_LE_TEST_END),
    HCI(BT_HCI_CMD_LE_CONN_PARAM_REQ_REPLY),
    HCI(BT_HCI_CMD_LE_CONN_PARAM_REQ_NEG_REPLY),
    HCI(BT_HCI_CMD_LE_SET_DATA_LENGTH),
    HCI(BT_HCI_CMD_LE_READ_DEFAULT_DATA_LENGTH),
    HCI(BT_HCI_CMD_LE_WRITE_DEFAULT_DATA_LENGTH),
    HCI(BT_HCI_CMD_LE_READ_LOCAL_PK256),
    HCI(BT_HCI_CMD_LE_GENERATE_DHKEY),
    HCI(BT_HCI_CMD_LE_ADD_TO_RESOLV_LIST),
    HCI(BT_HCI_CMD_LE_REMOVE_FROM_RESOLV_LIST),
    HCI(BT_HCI_CMD_LE_CLEAR_RESOLV_LIST),
    HCI(BT_HCI_CMD_LE_READ_RESOLV_LIST_SIZE),
    HCI(BT_HCI_CMD_LE_READ_PEER_RESOLV_ADDR),
    HCI(BT_HCI_CMD_LE_READ_LOCAL_RESOLV_ADDR),
    HCI(BT_HCI_CMD_LE_SET_RESOLV_ENABLE),
    HCI(BT_HCI_CMD_LE_SET_RESOLV_TIMEOUT),
    HCI(BT_HCI_CMD_LE_READ_MAX_DATA_LENGTH),
    HCI(BT_HCI_CMD_LE_READ_PHY),
    HCI(BT_HCI_CMD_LE_SET_DEFAULT_PHY),
    HCI(BT_HCI_CMD_LE_SET_PHY),
    HCI(BT_HCI_CMD_LE_ENHANCED_RECEIVER_TEST),
    HCI(BT_HCI_CMD_LE_ENHANCED_TRANSMITTER_TEST),
    HCI(BT_HCI_CMD_LE_SET_ADV_SET_RAND_ADDR),
    HCI(BT_HCI_CMD_LE_SET_EXT_ADV_PARAMS),
    HCI(BT_HCI_CMD_LE_SET_EXT_ADV_DATA),
    HCI(BT_HCI_CMD_LE_SET_EXT_SCAN_RSP_DATA),
    HCI(BT_HCI_CMD_LE_SET_EXT_ADV_ENABLE),
    HCI(BT_HCI_CMD_LE_READ_MAX_ADV_DATA_LEN),
    HCI(BT_HCI_CMD_LE_READ_NUM_SUPPORTED_ADV_SETS),
    HCI(BT_HCI_CMD_LE_REMOVE_ADV_SET),
    HCI(BT_HCI_CMD_LE_CLEAR_ADV_SETS),
    HCI(BT_HCI_CMD_LE_SET_PA_PARAMS),
    HCI(BT_HCI_CMD_LE_SET_PA_DATA),
    HCI(BT_HCI_CMD_LE_SET_PA_ENABLE),
    HCI(BT_HCI_CMD_LE_SET_EXT_SCAN_PARAMS),
    HCI(BT_HCI_CMD_LE_SET_EXT_SCAN_ENABLE),
    HCI(BT_HCI_CMD_LE_EXT_CREATE_CONN),
    HCI(BT_HCI_CMD_LE_PA_CREATE_SYNC),
    HCI(BT_HCI_CMD_LE_PA_CREATE_SYNC_CANCEL),
    HCI(BT_HCI_CMD_LE_PA_TERM_SYNC),
    HCI(BT_HCI_CMD_LE_ADD_DEV_PA_LIST),
    HCI(BT_HCI_CMD_LE_REMOVE_DEV_PA_LIST),
    HCI(BT_HCI_CMD_LE_CLEAR_PA_LIST),
    HCI(BT_HCI_CMD_LE_READ_PA_LIST_SIZE),
    HCI(BT_HCI_CMD_LE_READ_TX_POWER),
    HCI(BT_HCI_CMD_LE_READ_RF_PATH_COMPENSATION),
    HCI(BT_HCI_CMD_LE_WRITE_RF_PATH_COMPENSATION),
    HCI(BT_HCI_CMD_LE_SET_PRIV_MODE),
    HCI(BT_HCI_CMD_LE_RECEIVER_TEST_V3),
    HCI(BT_HCI_CMD_LE_TX_TEST_V3),
    HCI(BT_HCI_CMD_SET_PA_REC_ENABLE),
    HCI(BT_HCI_CMD_PERIODIC_SYNC_TRANS),
    HCI(BT_HCI_CMD_PA_SET_INFO_TRANS),
    HCI(BT_HCI_CMD_PA_SYNC_TRANS_PARAMS),
    HCI(BT_HCI_CMD_DEFAULT_PA_SYNC_TRANS_PARAMS),
    HCI(BT_HCI_CMD_LE_READ_BUFFER_SIZE_V2),
    HCI(BT_HCI_CMD_LE_READ_ISO_TX_SYNC),
    HCI(BT_HCI_CMD_LE_SET_CIG_PARAMS),
    HCI(BT_HCI_CMD_LE_SET_CIG_PARAMS_TEST),
    HCI(BT_HCI_CMD_LE_CREATE_CIS),
    HCI(BT_HCI_CMD_LE_REMOVE_CIG),
    HCI(BT_HCI_CMD_LE_ACCEPT_CIS),
    HCI(BT_HCI_CMD_LE_REJECT_CIS),
    HCI(BT_HCI_CMD_LE_CREATE_BIG),
    HCI(BT_HCI_CMD_LE_CREATE_BIG_TEST),
    HCI(BT_HCI_CMD_LE_TERM_BIG),
    HCI(BT_HCI_CMD_LE_BIG_CREATE_SYNC),
    HCI(BT_HCI_CMD_LE_BIG_TERM_SYNC),
    HCI(BT_HCI_CMD_LE_REQ_PEER_SCA),
    HCI(BT_HCI_CMD_LE_SETUP_ISO_PATH),
    HCI(BT_HCI_CMD_LE_REMOVE_ISO_PATH),
    HCI(BT_HCI_CMD_LE_ISO_TX_TEST),
    HCI(BT_HCI_CMD_LE_ISO_RX_TEST),
    HCI(BT_HCI_CMD_LE_ISO_READ_TEST_COUNTER),
    HCI(BT_HCI_CMD_LE_ISO_TEST_END),
    HCI(BT_HCI_CMD_LE_SET_HOST_FEATURE)};


const char* get_cmd_str(uint16_t opcode){
    return hci_cmds[opcode].c_str();
}

const char* get_evt_str(uint8_t opcode){
    if(opcode == BT_HCI_EVT_LE_META_EVENT)
        return hci_le_evts[opcode].c_str();
    return hci_evts[opcode].c_str();
}